----

### Směrování

- L3 vrstva (síťová)
- vidíme pouze zařízení, které se nachází ve stejné síti jako my
- pro "dotaz" do jiné sítě potřebujeme router
	- router také vidí pouze sítě, do kterých patří
- tento problém řeší **směrování**
	- data, která nemůžeme doručit přímo doručíme prostředníkovi
		- tomu kde je bude moci doručit přímo (**last-hop**)
		- tomu, kdo je blíže cíli (**mezilehlý router**)
		- tomu, kdo má větší šanci nalézt správnou cestu (**default-router**)
- **směrování = proces hledání nejlepší cesty pro data, která mají opustit naši lokální síť**

### Směrovací tabulka

- routing table
- v RAM paměti routeru
- udržuje informace, jak doručit data do neznámých sítí
- každý záznam obsahuje
	- adresu cílové sítě + masku
	- gateway sítě
	- název odchozího rozhraní (interface)
	- IP adresu dalšího routeru
	- metrika (výhodnost cesty)
- jelikož se v tabulce můžou nacházet duplicity => router heldá shodu s nejvýhodnější cestou

![[Pasted image 20230311174043.png]]

### Default route

- má nulovou masku (0.0.0.0/0)
- nejméně specifická
- shoduje se se všemi adresamí => vyhodnocuje se a posílá jako poslední
- IP datagram je pomocí default route předán nadřazenému routeru
	- pokud router zná cestu => pošle ho
	- pokud nezná cestu => datagram předá o úroveň výše dalšímu routeru

### Metrika

- vypočítá "kvalitu" cesty
- čím nižší => tím "kratší" cesta
- vypočítává se z vícero parametrů
	- počet hopů, cena, rychlost, stabilita, zatíženost

### Směrovací protokoly

- záznamy se do směrovací tabulky přidávají buď ručně, nebo automaticky
- ručně přidané záznamy = **statické routy**
	- rychlé, bezpečné
	- nevhodné pro velké sítě
- automaticky přidané záznamy = **dynamické routy**
	- pomocí směrovacích protokolů
	- router se naučí cestu k sítím, které nezná
	- stačí nastavit pouze jednou a poté fungují samy
	- přizpůsobují se topologii sítě (při výpadku vyhledají alernativu)

### Statické vs dynamické směrování

- u **dynamického směrování** nemusí administrátor znát topologii sítě
	- informace o jakýkoliv změnách se automaticky šíří sítí díky směrovacím protokolům
	- jednodušší administrace => protokol "dělá" práci za admina
- u **statického směrování** nastavujeme cesty "napevno"
	- větší bezpečnost
	- ale je málo flexibilní 


### Dynamické směrovací protokoly 

- **RIP**
	- distance-vector protocol = každý router má vlastní tabulku
	- Routing Information Protocol
	- princip fungování
		1. routery pravidelně vysílají své směrovací tabulky všem ostatním směrovačům v síti.  
		2. Každý router aktualizuje svou vlastní tabulku na základě informací, které obdrží od ostatních routerů. 
		3. Každý router vybírá cestu s nejmenším počtem skoků k dosažení cílové sítě.  
		4. Pokud existuje více cest se stejným počtem skoků, používá protokol RIP k určení nejlepší cesty metriku zvanou "hop count".  
		5. Pokud router selže (odpojí se), ostatní routery zjistí selhání a podle toho aktualizují své směrovací tabulky.  
		6. routery nadále pravidelně vysílají své směrovací tabulky, aby bylo zajištěno, že všechny směrovače mají nejaktuálnější směrovací informace.  
		7. Protokol RIP používá maximální počet skoků 15, což znamená, že pokud je síť vzdálena více než 15 skoků, je považována za nedosažitelnou.
	- první verze **RIP** posílala směrovací tabulky broadcastem => velká zátěž sítě
	- druhá verze **RIPv2** posílá směrovací tabulky multicastem + umí pracovat s podsítěmi a maskami sítě (CIDR)
	- nejnovější verze **RIPng** má podporu IPv6 + lepší autentizace

- **EIGRP**
	- hybridní protokol
	- Enhanced Interior Gateway Routing Protocol
	- pravidelně kontroluje, zda je trasa k dispozici
	- místo směrovací tabulky registruje změny topologie
	- podpora pro CIDR a proměnnou délku podsítí
		- Classless Inter-Domain Routing
		- maska je určena počtem bitů, nikoliv třídou IP adress
	- MD5 autentizace routerů mezi sebou
		- autorizace u prokolů typu OSPF, nebo BGP

- **OSPF**
	- link-state protocol
	- Open Shortest Path Find
	- provádí změny v tabulce na základě změn v síti
	- u samosprávných sítí se jedná o nejpoužívanější protokol
	- routery kontrolují ostatní routery
	- paměťově velmi náročný

### BGP

- distance-vector
- Border Gateway Protocol
- používají ho provideři (ISP)
- směrovací tabulky obsahují stovky až tisíce záznamů
- vyměňují se pouze informace o změnách, nikoliv celé tabulky

### Link-state protocoly

- protokoly pro správu sítě v rámci jedné domény (npř. firma)
- router zjišťuje, zda má v síti další routery a testuje jejich dostupnost
- poté routery informuje o jejich sousedech
	- každý router ví o všech ostatních 
- zmapuje se celá síť => může se určit nejlepší cesta pro daný packet
- rozlehlejší sítě je nutno rozdělit na části (velká zátěž na síť)

### Distance-vector protokoly

- routery neznají strukturu sítě, pouze své nejbližší sousedy
- vyměňují si kompletní kopii směrovacích tabulek
- routery periodicky vysílají a díky grafovému algoritmu vypočítávají vzálenost od ostatních uzlů
- vzniká riziko zacyklení

- 
## princip vzdáleného vektoru (distance-vector) vs link-state
# Výhody a nevýhody statického směrování vs dynamické směrování
# Příklad vytvoření směrovacích tabulek staticky a pomocí směrovacího protokolu (npř RIP)
